
요약
LSTM (Long Short-Term Memory) 네트워크는 시퀀스 학습을위한 최첨단 기술입니다. 이들은 금융 시계열 예측에 덜 일반적으로 적용되지만이 도메인에 본질적으로 적합합니다. 우리는 1992 년부터 2015 년까지 S & P 500의 구성 주식에 대한 학습에 사용되지 않는 샘플 데이터의 방향 이동을 예측하기위한 LSTM 네트워크를 구축합니다. 트랜잭션 비용 이전에 일일 수익률 0.46 %와 Sharpe 비율 5.8을 사용하여 LSTM 네트워크가 RAF(random forest), DNN (deep neural net) 및 LOG(logistic regression classifier)와 같은 메모리없는 분류 방법보다 성능이 우수하다는 것을 알 수 있습니다 . 일반 시장 대비 Outperform은 1992 년에서 2009 년 사이에 매우 명확하지만, 2010 년 현재 초과 수익률은 LSTM 수익성이 거래 비용 후 0에 변동하면서 차익 거래가 된 것으로 보인다. 우리는 수익성의 원천을 더 공개함으로써 인공 신경 네트워크의 블랙 박스에 빛을 퍼트립니다. 특히, 우리는 거래를 위해 선택된 주식들 중에서 하나의 공통적 인 패턴을 발견합니다 - 높은 변동성과 단기 반전 수익률 프로파일을 나타냅니다. 이러한 결과를 활용하여 우리는 거래 비용보다 0.23 % 높은 규칙 기반 단기 반전 전략을 공식화 할 수 있습니다. 더 많은 회귀 분석을 통해 LSTM이 시스템 리스크의 공통적 인 소스로 노출되는 것을 낮추었으며 세 가지 벤치 마크 모델과 비교했습니다.

1. 소개
금융 시계열에 대한 예측 작업은 주로 높은 수준의 노이즈와 일반적으로 인정되는 약간 강한 형태의 시장 효율성 (Fama, 1970)에 힘 입어 악명이 높습니다. 그러나 시장 효율성이라는 개념과 완전히 다른 유명한 자본 시장의 예외가 많이 있습니다. 예를 들어, Jacobs (2015) 또는 Green, Hand, and Zhang (2013)은 100 가지가 넘는 자본 시장 변이를 제공하는 설문 조사를 제공합니다. 설문 조사는 수익 예측 신호를 효과적으로 사용하여 시장을 능가합니다. 그러나 이러한 수익 예측 신호 (기능)와 미래 수익 (목표) 간의 관계를 설정하는 데 사용되는 재무 모델은 일반적으로 투명하며 복잡한 비선형 종속성을 포착 할 수 없습니다.

지난 몇 년 동안 기계 학습 기술은 금융 시장 데이터에서 (비선형) 구조를 식별 할 수 있다는 초기 증거가 입증되었습니다. Huck, 2009, Huck, 2010, Takeuchi and Lee (2013), Moritz and Zimmermann (2014 ), Dixon, Klabjan, Bang (2015), 그리고 Atsalakis와 Valavanis (2009), Sermpinis, Theofilatos, Karathanasopoulos, Georgopoulos 및 Dunis (2013)에 대한 더 자세한 내용이 있습니다. 특히 Krauss, Do, and Huck (2017)의 최근 작업을 비교 가능성을 위해 동일한 데이터 샘플로 확장합니다. 저자는 1992 년부터 2015 년까지 모든 S & P 500 구성 요소에 대한 예측 방법으로 심층 학습, 무작위 포리스트, 그라데이션 부스트 트리 및 다양한 앙상블을 사용합니다. 한 가지 중요한 사실은 트랜잭션 비용 이전에 하루 0.33 %의 수익률을 보이는 심층 신경 네트워크가 0.37 %의 그 레이디 언트 강화 트리와 0.43 %의 랜덤 포레스트가 다른것 만큼 잘하지 못한다는 것입니다. 후자의 사실은 깊은 학습이 "음성 인식, 시각적 물체 인식, 물체 탐지 및 기타 많은 영역에서 최첨단 기술을 획기적으로 향상 시켰습니다"(LeCun, Bengio 및 Hinton, 2015, 436 페이지 ). 언뜻보기에 우리는 시계열 예측 영역에서 비슷한 개선이 이루어질 것으로 기대합니다. 그러나, Krauss et al. (2017, p.695)는 "신경망은 훈련하기가 악명 높고 훈련이 어렵다"며 깊은 학습의 성과를 더욱 향상시키기위한 매개 변수 공간의 구성이있을 수 있다고 지적했다.

이 논문에서는 주로 딥 러닝과 대규모 시계열 예측 문제에 대한 잠재력을 탐색하는 데 중점을 둡니다. 이 점에서 우리는 문헌에 3 가지 기여를합니다.
•
첫째, 필기 인식, 음성 인식 또는 시계열 예측과 같은 시퀀스 학습 작업을위한 가장 진보 된 심층 학습 아키텍처 중 하나 인 LSTM (long-term-memory) 네트워크에 집중합니다 (Graves, Liwicki, Fernández, Bertolami, Bunke Schmidhuber, 2009, Graves, Mohamed, Hinton, 2013, Hochreiter, Schmidhuber, 1997, Schmidhuber, 2015). 놀랍게도, 우리가 아는 한, 대형 금융 시장 예측 업무에서의 성과를 평가하기 위해 대형, 유체 및 생존자 편향 주식 시장이란 우주에 LSTM 네트워크를 배치하려는 이전의 시도는 없었습니다. Xiong, Nichols 및 Shen (2015)와 같은 일부 응용 프로그램은 S & P 500의 변동성 예측, 적은 샘플의 외환 거래 비율 예측 (Giles, Lawrence, & Tsoi, 2001) 또는 특정 회사의 합병 뉴스의 영향 평가에 중점을 둡니다 (Siah and Myers, 2016). 우리는이 공백을 채우고 1992 년부터 2015 년까지 모든 S & P 500를 구성하는 회사에 LSTM 네트워크를 적용합니다. 이에 따라 시계열 예측 작업을위한 LSTM 네트워크의 개발, 교육 및 배포는 물론 데이터 전처리에 대한 심도있는 가이드를 제공합니다. 마지막으로, 우리가 찾은 문헌에서 선택된 기준인 랜덤 포레스트(최상의 성능 벤치 마크), 표준 심층 신경망(LSTM 아키텍처의 부가가치를 보여주기위한) 그리고 표준 로지스틱 회귀 분석법(기준선을 확립하기위한)과 대조한다. LSTM 네트워크는 메모리 프리 방식을 사용하여 통계적, 경제적으로 유의미한 수익률 0.46%를 기록했다. RAF는 0.43, DNN은 0.32, 선형 회귀는 0.26을 기록한다. 이 상대적 이점은 Diebold-Mariano 테스트가 적용된 벤치 마크와 비교하여 LSTM 네트워크의 우수한 예측을 확인하는 예측 정확도와 관련이 있습니다. 우리의 연구 결과는 미세 구조 효과에 크게 강합니다. 특히 가격을 종가보다 가중 평균 가격 (VWAP) 방식으로 LSTM 전략을 실행하면 수익성이 떨어지는 것을 볼 수 있지만 그 결과는 여전히 통계적으로나 경제적으로 중요합니다. 시그널 다음에 하루 대기 규칙을 도입 한 후에도 동일한 매출액을 가진 주간 구현은 마찬가지입니다. 2010 년을 기점으로 LSTM의 우위는 거래 비용으로 인해 LSTM 수익성이 제로 부근에서 변동하고 RAF 수익성이 마이너스 영역에 엄격하게 빠지면서 차익 거래를 한 것 같습니다.

•
둘째, 우리는 인공 신경망의 블랙 박스에 빛을 발산하여 수익성의 근원을 밝히는 것을 목표로합니다. 일반적으로 거래를 위해 선택된 주식은 높은 변동성, 평균 이하의 모멘텀, 거래 전 마지막 순간의 극한 방향의 움직임, 가까운 장래에 이러한 극단적 인 움직임을 뒤집을 경향이 있음을 알 수 있습니다.

•
셋째, LSTM이 이기고 잃는 주식을 선택하는 패턴의 본질을 포착하는 것을 목표로 단순화 된 규칙 기반 거래 전략으로 후반 부분의 결과를 종합합니다. 단기 극단적 인 패자를 매수하고 단기 극단적 인 승자를 팔는 전략은 거래 비용보다 0.23 %의 일일 수익을 가져 오므로 LSTM의 50 % 만 반환합니다. 체계적인 위험 요인에 대한 회귀 분석은 트랜잭션 비용 이전에 LSTM의 나머지 0.42 퍼센트를 공개하고 벤치 마크 모델에 비해 체계적인 위험의 일반적인 원인에 대한 노출이 일반적으로 낮습니다.


이 논문의 나머지 부분은 다음과 같이 구성된다. 2 절에서는 데이터 샘플, 소프트웨어 패키지 및 하드웨어에 대해 간략하게 설명합니다. 3 절에서는 우리의 방법론, 즉 훈련 및 거래 세트의 생성, 입력 시퀀스의 구축, 모델 아키텍처 및 교육은 물론 예측 및 거래 단계에 대한 심층적 인 토론을 제공합니다. 4 절에서는 결과를 제시하고 기존 문헌에 비추어 가장 관련성이 높은 결과를 논의합니다. 마지막으로 5 절이 끝납니다.

2. 데이터, 소프트웨어, 하드웨어
2.1. 데이터
경험적 적용을 위해 우리는 Thomson Reuters의 S & P 500 지수 구성 요소를 사용합니다. 생존자 편견을 제거하기 위해 1989 년 12 월부터 2015 년 9 월까지 Thomson Reuters의 S & P 500에 대한 모든 월 최종 구성 목록을 확보했습니다. 이 목록을 하나의 2 진 행렬로 통합하여 해당 주가가 다음 달의 색인 구성 요소인지 여부를 나타냅니다. 따라서 1989 년 12 월에서 2015 년 9 월 사이에 특정 시점에 S & P 500을 대략 재현 할 수 있습니다. 두 번째 단계에서는 그 기간 동안 지수의 구성 요소였던 모든 주식에 대해 1990 년 1 월부터 2015 년 10 월까지 매일 총 수익률 지수를 다운로드합니다. 수익률 지수는 배당 수익 가격이며 관련 기업 활동 및 주식 분할을 모두 고려하므로 수익 계산에 가장 적합한 지표가됩니다. Clegg와 Krauss (2018)에 이어 우리는 표 1의 평균 요약 통계를 산업 부문별로 나누어보고합니다. 이들은 섹터 별 가중치가 가중치가 매겨진 포트폴리오를 기반으로 매월 생성되며 S & P 500의 선거구 선정을 위해 제한됩니다.

2.2. 소프트웨어 및 하드웨어
데이터 준비 및 처리는 numpy (Van Der Walt, Colbert, & Varoquaux, 2011) 및 pandas (McKinney, 2010) 패키지에 의존하는 Python 3.5 (Python Software Foundation, 2016)에서 수행됩니다. 우리의 깊은 학습 LSTM 네트워크는 이기종 시스템에서 대규모 기계 학습을위한 강력한 라이브러리 인 Google TensorFlow 위에 keras (Chollet, 2016)로 개발되었습니다 (Abadi 외 2015). 또한, 무작위 산림 및 로지스틱 회귀 모델에 대해 sci-kit learn (Pedregosa et al., 2011)을 사용하고 표준 심층 그물에 대해 H2O (H2O, 2016)를 사용합니다. 성능 평가를 위해 통계 컴퓨팅 (R Core Team, 2016) 용 프로그래밍 언어 인 R과 Peterson and Carl (2014)의 PerformanceAnalytics 패키지로 되돌아갑니다. LSTM 네트워크는 NVIDIA GPU에서 교육되고 다른 모든 모델은 CPU 클러스터에서 교육됩니다.

삼. 방법론
우리의 방법론은 다섯 단계로 구성됩니다. 첫째, 훈련 세트 (샘플 내 교육용)와 거래 세트 (샘플 외 예측 용)로 구성된 학습 기간에 원시 데이터를 분리합니다. 둘째, 교육 및 예측에 필요한 특징 공간 및 목표에 대해 논의합니다. 셋째, LSTM 네트워크에 대한 심층적 인 토론을 제공합니다. 넷째, 무작위 숲, 심층 그물망, 우리가 적용하는 로지스틱 회귀 모형을 간략히 기술한다. 다섯째, 우리는 거래 접근법을 개발합니다. 이 섹션의 나머지 부분은 위에 설명 된 5 단계 논리를 따릅니다.

3.1. 교육 및 거래 세트 생성
Krauss et al. (2017), 우리는 750 일 (약 3 년)의 훈련 기간과 250 일 (약 1 년)의 거래 기간으로 구성된 훈련 무역 집합으로 "연구 기간"을 정의합니다. 우리는이 연구 기간 중 23 회에 걸쳐 1990 년부터 2015 년까지 전체 데이터 세트를 겹치지 않는 거래 기간으로 나누었습니다. 즉, 연구 기간은 1000 일의 롤백 블록입니다. 교육은 첫 750 일 동안의 롤링 창으로 수행됩니다. 즉, 블록 전체에서 240 일 (최대 기능 길이에 해당하는 섹션 3.2 참조)의 룩백 입력을 롤링 한 다음 하루 앞당치를 예측하여 교육을 수행합니다. 트레이딩은 지난 250 일 동안 숙련 된 매개 변수를 사용하여 완전히 샘플 밖에서 수행됩니다. 그런 다음 전체 시스템이 250 일 롤 포워드되어 총 23 개의 중복되지 않는 거래 기간이 발생합니다.

ni는 연구 기간 i의 훈련 마지막 날 S & P 500 구성 종목의 수를 나타내므로 ni는 500.2에 매우 가깝다

훈련 세트를 위해, 우리는 그들이 가지고있는 역사가있는 모든 주식을 고려한다. 일부 주식은 750 일간의 전체 교육 기록을 보여 주며, 일부는이 기간의 하위 집합 일뿐입니다. 예를 들어, 이후 단계에 기록됩니다. 거래 세트는 또한 모든 주식으로 구성됩니다. 거래 기간 중 특정 날짜 이후에 가격 정보가없는 경우 해당 날짜까지 거래가 이루어진 것으로 간주됩니다 .3

3.2. 기능 및 대상 생성
3.2.1. 특징 - LSTM 네트워크의 반환 시퀀스

3.2.1. 특징 - LSTM 네트워크의 반환 시퀀스
하자를 시간 t에서 주식의 가격 과정으로 정의하고, m 기간 동안의 주식에 대한 간단한 수익, 즉,
(1)
LSTM 네트워크의 경우, 우리는 먼저 하루 t와 각 주식 s에 대한 하루 수익률을 계산하여 차원 ni × Tstudy의 하나의 큰 특성 벡터 V에 쌓습니다. 여기서 Tstudy는 연구 기간의 일 수를 나타냅니다. 그런 다음 mean ()을 뺀 다음 훈련 세트에서 얻은 표준 편차 ()로 나누어 반환 값을 표준화합니다.
(2)

LSTM 네트워크는 훈련을위한 일련의 입력 특징, 즉 연속적인 시점에서의 특징 값을 요구한다. 우리의 단일 기능은 표준화 된 1 일 반품입니다. 우리는 약 240 개의 시퀀스 길이를 선택하여 대략 한 거래 연도의 정보를 포함합니다. 따라서 우리는 다음과 같은 방법으로 240 개의 연속 된 표준화 된 1 일 수익률의 중첩 시퀀스를 생성한다. 먼저, 특징 벡터 V를 주식으로, 날짜 t를 오름차순으로 정렬한다. 그 다음, 우리는 연구 기간의 각 주식 s 및 각 t ≥ 240에 대한 형태의 순서를 구성한다. 따라서 첫 번째 재고 s1에 대한 순서는 표준화 된 1 일 반품으로 구성됩니다. 두 번째 시퀀스는 등으로 구성됩니다. 실례가도 1에 제공되어있다. 전체적으로 각 연구 기간은 약 380,000 건의 시퀀스로 구성되며,이 중 약 255,000 건은 샘플 내 교육에 사용되고 약 125,000 건은 샘플 밖 예측에 사용됩니다 .5

도 1
고해상도 이미지 다운로드 (415KB) 풀 사이즈 이미지 다운로드
그림 1. LSTM 네트워크에 대한 입력 시퀀스의 구성 (특징 벡터 및 시퀀스 모두가 전치 됨)

3.2.2. 목표
비교 가능성을 위해서 Takeuchi and Lee (2013)를 따르고 이원 분류 문제를 정의합니다. 즉, 각 주식 및 날짜에 대한 응답 변수는 두 가지 다른 값을 가질 수 있습니다. 두 클래스를 정의하기 위해, 모든 주식의 모든 1 주 수익률을 기간의 오름차순으로 정렬하고 두 개의 동일한 크기의 클래스로 잘라냅니다. Class 0은 주식의 1 회 수익률이 모든 주식의 횡단면 수익률보다 작 으면 실현됩니다. 유사하게, s의 1주기 반환이 횡단면 중앙값보다 크거나 같으면 클래스 1이 실현됩니다.

3.3. LSTM 네트워크
LSTM 네트워크에 대한 설명은 Graves (2013), Olah (2015) 및 Chollet (2016)에 이어집니다. 귀중한 추가 소개 Karpathy (2015)와 Britz (2015)에서 단계별 그래픽 연습과 코드 스 니펫을 제공합니다.

LSTM 네트워크는 재발 성 신경망 (RNN)의 분류에 속하며, "신경 간 연결의 토폴로지가 적어도 하나의주기를 포함합니다"(Medsker, 2000, 82). 그들은 Hochreiter와 Schmidhuber (1997)에 의해 소개되었고 다음 몇 년 동안 Gers, Schmidhuber, Cummins (2000), Graves와 Schmidhuber (2005)와 같은 몇 년 동안 더 세련되었다. LSTM 네트워크는 장기 종속성을 배우기 위해 특별히 설계되었으며 RNN의 이전에 내재 된 문제, 즉 소멸 및 폭발 그라디언트 (Sak, Senior, & Beaufays, 2014)를 극복 할 수 있습니다.

LSTM 네트워크는 입력 레이어, 하나 이상의 숨겨진 레이어 및 출력 레이어로 구성됩니다. 입력 레이어의 뉴런 수는 설명 변수의 수 (피쳐 공간)와 같습니다. 출력 계층의 뉴런 수는 출력 공간, 즉 주식이 횡단면 중앙값을 outperform하는지 여부를 나타내는 두 개의 뉴런을 반영합니다. LSTM 네트워크의 주요 특징은 소위 메모리 셀로 구성된 숨겨진 계층에 포함됩니다. 각각의 메모리 셀은 잊혀진 게이트 (ft), 입력 게이트 (it) 및 출력 게이트 (ot)를 유지하고 조정하는 3 개의 게이트를 갖는다. 메모리 셀의 구조는도 2에 도시되어있다.

도 2
고해상도 이미지 다운로드 (318KB) 풀 사이즈 이미지 다운로드
도 2. Graves (2013) 및 Olah (2015)에 이어 LSTM 메모리 셀의 구조.

모든 타임 스텝 t에서, 3 개의 게이트 각각은 이전 타임 스텝에서의 메모리 셀의 출력뿐만 아니라 입력 xt (입력 시퀀스의 하나의 요소)로 제공된다. 이로써 게이트는 각각 다른 목적을 수행하는 필터 역할을합니다.
•
잊어 버린 게이트는 어떤 정보가 셀 상태에서 제거되는지 정의합니다.

•
입력 게이트는 어떤 정보가 셀 상태에 추가되는지를 지정합니다.

•
출력 게이트는 셀 상태의 정보가 출력으로 사용되도록 지정합니다.

아래 방정식은 벡터화되고 모든 타임 스텝 t에서 LSTM 레이어의 메모리 셀 업데이트를 설명합니다. 이로써 다음 표기법이 사용됩니다.
•
xt는 타임 스텝 t에서의 입력 벡터입니다.

•
Wf, x, Wf, h, Wi, x, Wi, h, Wo, x 및 Wo, h는 가중치 행렬이다.

•
bf, bi 및 bo는 바이어스 벡터이다.

•
ft, it 및 ot는 각 게이트의 활성화 값에 대한 벡터입니다.

•
st 및는 셀 상태 및 후보 값에 대한 벡터이다.

•
ht는 LSTM 계층의 출력 벡터입니다.

순방향 패스 (forward pass) 동안, 셀 상태 (st) 및 시간 스텝 t에서 LSTM 층의 출력 ht는 다음과 같이 계산된다 :

첫 번째 단계에서 LSTM 계층은 어떤 정보를 이전 셀 상태에서 제거해야하는지 결정합니다. 그러므로, 타임 스텝 t에서의 잊어 버린 게이트의 활성화 값 ft는 현재 입력 xt, 이전 타임 스텝 ()에서의 메모리 셀의 출력, 및 잊어 버린 게이트의 바이어스 항 bf에 기초하여 계산된다. 시그 모이 드 함수는 마지막으로 모든 활성화 값을 0 (완전히 잊어 버림)에서 1 (완전히 기억) 사이의 범위로 조정합니다.
(삼)
두 번째 단계에서 LSTM 계층은 네트워크의 셀 상태 (st)에 어떤 정보를 추가해야하는지 결정합니다. 이 절차는 두 가지 작업으로 구성됩니다. 첫째, 잠재적으로 셀 상태에 추가 될 수있는 후보 값이 계산됩니다. 둘째, 입력 게이트의 활성화 값이 계산됩니다.
(4)
(5)
세 번째 단계에서, 새로운 셀 상태 st는 이전의 두 단계의 결과를 기반으로 계산되어 Hadamard (요소 단위) 제품임을 나타냅니다.
(6)
마지막 단계에서 메모리 셀의 출력 ht는 다음의 두 방정식에 나타난 것과 같이 유도된다.
(7)
(8)
입력 시퀀스를 처리 할 때 해당 기능은 LSTM 네트워크에 시간 단계별로 시간 단계로 표시됩니다. 따라서 각 타임 스텝 t (이 경우 하나의 단일 표준화 된 수익)의 입력은 위의 수식에 표시된대로 네트워크에서 처리됩니다. 시퀀스의 마지막 요소가 처리되면 전체 시퀀스의 최종 출력이 반환됩니다.

트레이닝 중에는 전통적인 피드 포워드 네트워크와 유사하게 가중치 및 바이어스 조건이 훈련 샘플에서 지정된 목적 함수의 손실을 최소화하는 방식으로 조정됩니다. 우리가 분류 문제를 다루기 때문에, 우리는 객관적인 함수로서 교차 엔트로피를 사용합니다.

학습되는 가중치 및 바이어스 조건의 수는 다음과 같이 계산된다 : h는 LSTM 층의 숨은 단위의 수를 나타내고, i는 입력 특징의 수를 나타내며, 그 다음에 훈련 될 필요가있는 LSTM 층의 파라미터의 수는 :
(9)
여기서 4hi는 각 게이트에서 입력에 적용된 4 개의 가중치 행렬의 크기, 즉 Wo, x를 나타냅니다. 4h는 4 개의 바이어스 벡터 (및 bo)의 크기를 나타냅니다. 마지막으로, 4h2는 이전 타임 스텝에서 출력에 적용된 가중치 행렬의 차원, 즉 Wo, h에 해당합니다.

LSTM 네트워크의 교육을 위해 keras를 통해 세 가지 고급 방법을 적용합니다. 첫째, 최적화 도구 인 rprop (Tieleman & Hinton, 2012)의 미니 배치 버전 인 RMSprop을 사용합니다. RMSprop의 선택은 "일반적으로 반복적 인 신경 회로망을위한 좋은 선택"이므로 문헌에서 동기 부여됩니다 (Chollet, 2016). 둘째, Gal and Ghahramani (2016)에 이어 우리는 재발 성 층 내에서 드롭 아웃 정규화를 적용한다. 이로써, 입력 게이트 및 반복적 인 연결 모두에서 학습 시간 동안 입력 장치의 일부가 무작위로 각 업데이트마다 삭제되므로 초과 피팅 및 일반화의 위험이 줄어 듭니다. 1991 년 초기 실험 (샘플 밖 거래 기간의 일부로 사용되지 않음)에 기반하여, 우리는 더 높은 탈락 가치가 성과의 하락과 함께 진행되어 상대적으로 낮은 탈락 가치를 가짐을 관찰했습니다 0.1이다. 셋째, 각 학습 기간에 개별적으로 교육을위한 에포크 수를 동적으로 유도하고 과도한 리스크를 줄이기 위해 조기 정지를 사용합니다. 이로써 훈련 샘플은 하나의 훈련과 하나의 검증 세트의 두 세트로 나뉩니다. 첫 번째 세트는 네트워크를 교육하고 손실 함수가 최소화되도록 매개 변수를 반복적으로 조정하는 데 사용됩니다. 각 신기원 (첫 번째 집합의 샘플을 가로 지르는 한 패스) 후에 네트워크는 유효성 검사 집합에서 보이지 않는 샘플을 예측하고 유효성 검사 손실이 계산됩니다. 인내 기간 동안 유효성 검사 손실이 감소하지 않으면 교육이 중지되고 유효성 검사 손실이 가장 낮은 모델의 가중치가 복원됩니다 (Chollet, 2016의 ModelCheckpoint 콜백 참조). Granger (1993)는 샘플의 약 20 %를 "사후 샘플"데이터로 유지할 것을 제안하고 있으며, 훈련 샘플의 80 %를 검증 세트로 사용하고 20 %를 유효성 검증 세트로 사용합니다 (샘플은 임의의 훈련 또는 검증 세트), 최대 교육 기간 1000 epoch, 조기 인내 인내 10. 따라서 훈련 된 LSTM 네트워크의 지정된 토폴로지는 다음과 같습니다.
•
1 특징 및 240 타임 스텝을 가진 입력 레이어.

•
숨겨진 뉴런과 드롭 아웃 값이 0.1 인 LSTM 레이어. 이 구성은 LSTM에 대해 2752 개의 매개 변수를 산출하므로 매개 변수 당 대략 93 개의 학습 예제가 가능합니다. 이 값은 Krauss et al.의 deep net 구성과 유사하게 선택되었습니다. (2017). 파라미터 당 관측치가 높으면 잡음이 많은 훈련 데이터의 경우 견고한 추정치를 얻을 수 있고 과도한 사고의 위험을 줄일 수 있습니다.

•
두 개의 뉴런과 softmax 활성화 기능을 갖춘 출력 레이어 (dense layer) - 표준 구성.


3.4. 벤치 마크 모델 - 임의의 숲, 깊은 그물 및 로지스틱 회귀
LSTM을 벤치마킹하기 위해 우리는 강건하면서도 고성능의 기계 학습 방법, LSTM의 이점을 보여주는 표준 심층 그물망, 기준선과 같은 로지스틱 회귀 (즉, 표준 분류 자)를 선택합니다. 랜덤 포리스트, 표준 심층 그물 및 메모리없는 방법의 피쳐 생성은 Krauss et al. (2017)에 대한 벤치마킹 이유. 특히 누적 수익률을 피쳐로 사용합니다. (1)과 3.2.2 절에서 정의 된 것과 동일한 목표물. 로지스틱 회귀 모델의 경우, 우리는 수식으로 나타낸 바와 같이 수익률을 표준화한다. (2) .7 다음 단락에서는 우리가 벤치마킹 방법을 어떻게 보정하는지 간략하게 설명합니다.

무작위 포리스트 : 무작위 결정 포리스트에 대한 첫 번째 알고리즘은 Ho (1995)에 의해 제안되었으며 나중에 Breiman (2001)에 의해 확장되었습니다. 말하자면, 무작위 포리스트는 교육 데이터의 서로 다른 부트 스트랩 샘플을 기반으로 구축 된 심층이지만 상관 관계가없는 의사 결정 트리로 구성됩니다. 무작위 포리스트 알고리즘에는 두 가지 핵심 기술이 사용됩니다. 무작위 기능을 사용하여 나무를 서로 연관시키지 않고 서로 다른 부트 스트랩 샘플에 빌드 할 수 있습니다. 알고리즘은 매우 간단합니다.위원회의 B 트리 각각에 대해 교육 데이터에서 부트 스트랩 샘플을 가져옵니다. 부트 스트랩 샘플에서 의사 결정 트리가 개발됩니다. 각 분할에서 p 피쳐의 부분 집합 m만이 잠재적 분할 기준으로 사용 가능합니다. 최대 깊이 J에 도달하면 성장이 멈 춥니 다. 최종 산출물은 B 수목원위원회이며 다수결 투표로 분류됩니다. 나무 B의 수를 1000으로 설정하고 최대 깊이를 설정하여 실질적인 고차원 상호 작용을 허용합니다. 랜덤 피쳐 선택은 분류를위한 기본값으로 남습니다 (Pedregosa et al. (2011).

우리는 두 가지 이유에서 벤치 마크로서 임의의 숲을 사용합니다. 첫째, 사실상 튜닝을 필요로하지 않고 일반적으로 좋은 결과를 제공하는 최첨단 기계 학습 모델입니다. 둘째로,이 구성에서 임의의 포리스트는 Krauss et al. (2017) 및 월간 주식 시장 데이터에 대한 대규모 기계 학습 응용 프로그램 인 Moritz and Zimmermann (2014)의 선택 방법에 대해 설명합니다. 따라서 임의의 포리스트는 모든 혁신적인 기계 학습 모델의 강력한 벤치 마크 역할을합니다.

심층 신경 네트워크 : 표준 DNN을 배포하여 LSTM 네트워크의 상대적 이점을 보여줍니다. 특히 우리는 31 개의 입력 뉴런, 처음에는 31 개의 뉴런, 두 번째에는 10 개의 뉴런, 3 번째 숨겨진 레이어에는 5 개, 출력 레이어에는 2 개의 뉴런을 가진 피드 포워드 뉴럴 네트워크를 사용합니다. 활성화 기능은 Goodfellow, Warde-Farley, Mirza, Courville 및 Bengio (2013) 및 출력 레이어의 softmax에 이어 두 개의 채널로 maxout입니다. 드롭 아웃은 0.5로 설정되고 수축량 0.00001의 L1 정규화가 사용됩니다 (Krauss et al. 참조). (2017)을 참조하십시오.

로지스틱 회귀 : 기본 모델로서 로지스틱 회귀를 전개합니다. 우리의 구현에 관한 세부 사항은 sci-kit learn (Pedregosa et al., 2011)의 문서와 그 참조 문헌에서 확인할 수 있습니다. 최적의 L2 정규화는 각각의 트레이닝 세트에서 5 배 교차 검증을 통해 0.0001과 10,000 사이의 로그 스케일에서 100 개의 선택 중에서 결정되며, 최대 반복 횟수를 100으로 제한하면서 최적을 찾기 위해 L-BFGS가 전개됩니다. 로지스틱 회귀 (logistic regression)는 기준선 역할을하므로 표준 분류 기준과 비교하여 훨씬 더 복잡하고 계산 집약적 인 LSTM 네트워크의 점진적 부가 가치를 도출 할 수 있습니다.

3.5. 예측, 순위 지정 및 거래
모든 모델에 대해, 우리는 각 주식이 시간 t에서 정보 사용 만하는 기간의 횡단면 중앙값을 out / underperform 할 확률을 예측한다. 그런 다음, 각 기간의 모든 주식을이 확률의 내림차순으로 순위를 매 깁니다. 순위의 최상위는 횡단면 중간 값을 outperform 할 것으로 예상되는 가장 저평가 된 주식에 해당합니다. 따라서 우리는 2k 주식으로 구성된 장단점이있는 포트폴리오에 대해 각 순위의 최상위 k를 오가며 플롭 k 주식을 짧게합니다 - Huck, 2009, Huck, 2010을 참조하십시오.

4. 결과
우리의 결과는 세 단계로 나타납니다. 먼저, Avellaneda와 Lee (2010)에 따라 거래 비용 전후 5 bps의 반 환을 분석하고 LSTM 네트워크의 성능을 무작위 숲, 심 신경 망 및 로지스틱 회귀와 대조합니다. 둘째, 최상위 및 최저주의 공통 패턴을 도출하여 수익성의 근원을 밝힙니다. 셋째, 이러한 결과를 바탕으로 간소화 된 거래 전략을 개발하고 투명한 거래 규칙으로 가장 가시적 인 패턴을 포착하여 LSTM 성과를 달성 할 수 있음을 보여줍니다.

4.1. 성과 검토
4.1.1. 개요
먼저 2k 종목으로 구성된 포트폴리오의 특성, 즉 우리가 오래가는 최상 k 종목과 짧은 종목을 분석한다. 우리는 k ∈ {10, 50, 100, 150, 200}을 선택하고 새로운 LSTM의 성능을 하루 평균 수익률, 연간 표준 편차, 연간 Sharpe 비율 및 정확도와 함께 다른 접근법과 비교한다. .

우리는 다음과 같은 추세를 보았습니다. 포트폴리오 크기 k와 관계없이 LSTM은 다른 접근법에 비해 유리한 특성을 보여줍니다. 특히 거래 비용 이전의 일별 수익률은 RAF 0.43 %, DNN 0.32 %, LOG 0.26 %와 비교하여 0.46 %입니다. 또한 더 큰 포트폴리오 크기의 경우 LSTM은 RAF와 연결된 위치를 제외하고는 하루 평균 평균 수익률이 가장 높습니다. 표준 편차 (위험 측정 기준)와 관련하여 LSTM은 RAF와 비슷한 수준이며, 포트폴리오 크기를 약간 늘리면 값이 약간 높고 값이 약간 높습니다. LSTM과 RAF는 DNN과 로지스틱 회귀 (logistic regression)보다 훨씬 낮은 표준 편차를 나타냅니다. Sharpe 비율 또는 위험 단위당 수익률은 RAF의 표준 편차가 낮을수록 LSTM의 수익률이 높을 때 더 큰 포트폴리오의 경우 RAF까지 RAF보다 높거나 낮습니다. 정확한 분류의 몫을 의미하는 정확성은 중요한 기계 학습 메트릭입니다. 우리는 포트 폴리오에 대한 LSTM의 명백한 이점을 알았으며, 크기가 증가함에 따라 RAF와 약간의 차이가 있었고 넥타이를 보았습니다.

우리는 장단점이있는 포트폴리오에 대한 후속 분석에 초점을 맞 춥니 다.

4.1.2. 예측 정확도에 대한 세부 정보
고용 된 기계 학습 방법의 주요 임무는 주식이 횡단면 중앙값을 능가하는지 아닌지를 정확하게 예측하는 것입니다. 이 단락에서 우리는 LSTM 예측의 예측 정확도를 다른 방법의 예측 정확도와 임의 추측에 대해 벤치마킹합니다. 또한 LSTM의 재무 성과를 무작위로 생성 된 10 만개의 long-short 포트폴리오와 비교합니다.

먼저 방법 i의 예측이 i, j ∈ {LSTM, RAF, DNN, LOG} 인 방법 j의 예측보다 열등한 정확도를 갖는 null을 평가하기 위해 Diebold and Mariano (1995) (DM) i ≠ j이다. 각 방법의 각 예측에 대해 포트폴리오의 개별 재고가 올바르게 분류 된 경우 0을 지정하고 그렇지 않으면 1을 할당하고이 분류 오류 벡터를 DM 테스트의 입력으로 사용합니다. 따라서 총 5750 거래일 동안 포트폴리오의 개별 주식 예측을 고려합니다. 결과는 표 2의 패널 A에 묘사되어있다. 첫 번째 행에서 LSTM 예측이 RAF, DNN 또는 LOG의 예측보다 낮다는 사실을 알기 위해 각각 0.0143, 0.0037 및 0.0000의 p- 값을 얻습니다. 우리가 5 % 유의 수준에서 테스트하고 3 가지 비교에 대해 Bonferroni 보정을 적용하면 조정 된 유의 수준은 1.67 %이며 LSTM 예측이 RAF, DNN보다 정확하지 않다고 개별 귀무 가설을 여전히 거부 할 수 있습니다 LOG 예측. 그러므로 LSTM 예측이 다른 고려 된 방법의 예측보다 우수하다고 가정하는 것이 합리적입니다. 마찬가지로 우리는 RAF 예측이 LOG 예측보다 열등하다는 Null을 거부 할 수 있으며 DNN 예측이 LOG 예측보다 열등하다는 Null을 거부 할 수 있습니다. 다른 말로하면, 정교한 기계 학습 접근법의 예측은 표준 로지스틱 회귀 분류 자보다 더 뛰어납니다. 외관상으로는, 전자는 표준 로지스틱 회귀에 의해 추출 될 수없는 재무 적 시계열 데이터의 복잡한 종속성을 포착 할 수 있습니다. 그러나 DM 테스트 매트릭스에서 우리는 RAF 예측이 DNN 예측보다 우월하거나 그 반대로 추정 할 수 없습니다. 두 방법 모두 비슷한 예측 정확도를 보이는 것으로 나타났습니다. LSTM 네트워크는 상당히 높은 계산 비용에도 불구하고 예측 정확도 측면에서 선택 방법입니다.

표 2. 패널 A : 방법 i의 예측이 방법 j의 예측보다 열등한 정확도를 갖는 귀무 가설에 대한 Diebold-Mariano (DM) p 값. 패널 B : 예측과 반응이 독립적으로 분포한다는 귀무 가설에 대한 Pesaran-Timmermann (PT) 검정의 p- 값. 두 패널 모두 1992 년 12 월부터 2015 년 10 월까지 포트폴리오를 기반으로합니다.

A : DM 검사 B : PT 검사
i j = LSTM RAF DNN LOG 방법 결과
LSTM - 0.0143 0.0037 0.0000 LSTM 0.0000
RAF 0.9857 - 0.3180 0.0000 RAF 0.0000
DNN 0.9963 0.6820 - 0.0000 DNN 0.0000
로그 1.0000 1.0000 1.0000 - LOG 0.0000
두 번째로, Pesaran-Timmermann (PT) 테스트를 사용하여 각 예측 방법에 대해 예측 및 응답이 독립적으로 분배된다는 귀무 가설을 평가합니다. 우리는 제 4 자릿수까지 p 값이 제로인 것을 발견하여 어떤 의미있는 수준에서도 널을 거부 할 수 있음을 암시합니다. 즉, 우리가 사용하는 각 기계 학습 방법은 통계적으로 유의 한 예측 정확도를 나타냅니다.

셋째, 우리는 LSTM 네트워크가 이러한 결과를 무작위로 달성 할 확률에 대한 통계적 추정치를 제공합니다. 우리는 합계 54.3 %가 정확하게 분류 된 최고 및 최저 주식을 고려합니다. LSTM 네트워크의 실제 정확도가 실제로 50 %라면, 우리는 "성공"의 수, 즉 2 진 분포가있는 최상위 / 플롭의 올바르게 분류 된 주식 X의 수를 모델링 할 수 있습니다. 그런 큰 n을 위해,. 이제 LSTM 네트워크의 정확도가 50 % 인 경우 54.3 % 이상의 정확도를 얻을 확률을 쉽게 계산할 수 있습니다. Maechler (2016)의 R 패키지 Rmpfr을 사용하여 다중 정밀도 부동 소수점 수를 계산하고 무작위 분류기가 우연히 LSTM과 함께 수행하는 확률 2.7742e187을 계산합니다.

마침내 우리는 Wall Street Journal의 주식 페이지 (Malkiel, 2007)에서 Malkiel의 원숭이가 다트를 던지는 것을 감안하여 무작위로 샘플링 한 포트폴리오 10 만개의 재무 성과를 평가합니다. 이로써 우리는 무작위로 짧은 포트폴리오의 10 개 종목을 긴 종목과 10 개 종목에 대해 각각 5750 거래일 동안 대체하지 않고 샘플링합니다. 5750 일 동안이 모든 포트폴리오는 원숭이가 선택한 포트폴리오로 해석 될 수 있습니다. 그런 다음 원숭이의 성과를 평가하기 위해 5750 일 동안 결합 된 long-short 포트폴리오의 평균 평균 일일 수익을 계산합니다. 100,000 개의 다른 원숭이들과 같은 10 만 번의 복제 결과가 그림 4에 나와 있습니다. 예상대로 트랜잭션 비용보다 평균 일일 평균 수익률은 0입니다. 더 중요한 것은 평균 일일 수익률이 0.05 % 인 최고 실적의 "원숭이"조차도 그림 3에 표시된 적용 모델의 결과에 근접하지 않습니다.

도 3
고해상도 이미지 다운로드 (711KB) 풀 사이즈 이미지 다운로드
도 3 1992 년 12 월부터 2015 년 10 월까지 평균 크기 (거래 비용 제외), 표준 편차, 연간 Sharpe 비율 (거래 비용 제외) 및 정확도와 같은 다양한 크기의 긴 짧은 포트폴리오의 일별 실적 특성.

도 4
고해상도 이미지 다운로드 (115KB) 풀 사이즈 이미지 다운로드
도 4. 원숭이가 거래하는 장단기 포트폴리오 (거래 비용 제외)를 샘플링 한 평균 일일 수익률의 경험적 분포.

4.1.3. 재무 실적 세부 정보
표 3은 트랜잭션 비용 전후의 벤치 마크와 비교 한 LSTM의 재무 성과에 대한 통찰력을 제공합니다.

표 3. 패널 A, B 및 C는 1992 년 12 월부터 2015 년 10 월까지 RAF, DNN, LOG 및 일반 시장 (MKT)과 비교하여 LSTM에 대한 거래 비용 전후의 포트폴리오의 성과 특성을 보여줍니다. MKT는 Kenneth R. French의 데이터 라이브러리에서 일반적인 시장을 나타냅니다. 여기를 참조하십시오. 패널 A는 일별 수익률 특성을 나타냅니다. 패널 B는 일일 위험 특성을 나타냅니다. 패널 C는 연간 환급 리스크 측정 지표를 보여줍니다. One-lag 보정이있는 Newey-West 표준 오류가 사용됩니다.

거래 비용 전 거래 비용 후 
LSTM RAF DNN LOG LSTM RAF DNN LOG MKT
평균 반환 값 (long) 0.0029 0.0030 0.0022 0.0021 0.0019 0.0020 0.0012 0.0011 -
평균 복귀 (짧은) 0.0017 0.0012 0.0010 0.0005 0.0007 0.0002 0.0000 0.0005 -
평균 반환 값 0.0046 0.0043 0.0032 0.0026 0.0026 0.0023 0.0012 0.0006 0.0004
표준 오차 0.0003 0.0003 0.0004 0.0004 0.0003 0.0003 0.0004 0.0004 0.0001
t- 통계량 16.9336 14.1136 8.9486 7.0006 9.5792 7.5217 3.3725 1.6666 2.8305
최소 0.2176 0.2058 0.1842 0.1730 0.2196 0.2078 0.1862 0.1750 0.0895
사 분위수 1 0.0053 0.0050 0.0084 0.0089 0.0073 0.0070 0.0104 0.0109 0.0046
중앙값 0.0040 0.0032 0.0025 0.0022 0.0020 0.0012 0.0005 0.0002 0.0008
사 분위수 3 0.0140 0.0124 0.0140 0.0133 0.0120 0.0104 0.0120 0.0113 0.0058
최대 0.1837 0.3822 0.4284 0.4803 0.1817 0.3802 0.4264 0.4783 0.1135
점유율> 0 0.6148 0.6078 0.5616 0.5584 0.5574 0.5424 0.5146 0.5070 0.5426
표준 dev. 0.0209 0.0215 0.0262 0.0269 0.0209 0.0215 0.0262 0.0269 0.0117
비뚤어 짐 0.1249 2.3052 1.2724 1.8336 0.1249 2.3052 1.2724 1.8336 0.1263
첨도 11.6967 40.2716 20.6760 30.2379 11.6967 40.2716 20.6760 30.2379 7.9791
B 1 % VaR 0.0525 0.0475 0.0676 0.0746 0.0545 0.0495 0.0696 0.0766 0.0320
1 % CVaR 0.0801 0.0735 0.0957 0.0995 0.0821 0.0755 0.0977 0.1015 0.0461
5 퍼센트 VaR 0.0245 0.0225 0.0333 0.0341 0.0265 0.0245 0.0353 0.0361 0.0179
5 % CVaR 0.0430 0.0401 0.0550 0.0568 0.0450 0.0421 0.0570 0.0588 0.0277
맥스. 삭감 0.4660 0.3187 0.5594 0.5595 0.5233 0.7334 0.9162 0.9884 0.5467
C Return pa 2.0127 1.7749 1.0610 0.7721 0.8229 0.6787 0.2460 0.0711 0.0925
초과 반환 파 1.9360 1.7042 1.0085 0.7269 0.7764 0.6359 0.2142 0.0437 0.0646
표준 dev. 아빠 0.3323 0.3408 0.4152 0.4266 0.3323 0.3408 0.4152 0.4266 0.1852
아래쪽 dev에. 아빠 0.2008 0.1857 0.2524 0.2607 0.2137 0.1988 0.2667 0.2751 0.1307
샤프 비율 PA 5.8261 5.0001 2.4288 1.7038 2.3365 1.8657 0.5159 0.1024 0.3486
Sortino 비율 PA 10.0224 9.5594 4.2029 2.9614 3.8499 3.4135 0.9225 0.2583 0.7077
Return characteristics : 표 3의 패널 A에서 LSTM이 유리한 수익률 특성을 보임을 알 수있다. 트랜잭션 비용 후 평균 0.46 %와 0.26 %의 평균 수익률은 Newey-West t- 통계량이 트랜잭션 비용 후 16.9336과 9.5792로 통계적으로 유의미하며 임계 값 1.9600 (5 % 유의 수준)과 비교하여 통계적으로 유의미합니다. 중앙값은 평균 수익률보다 약간 작으며, 최소값과 최대 값뿐만 아니라 4 분위수는 결과가 특이 치에 의해 야기되지 않음을 나타냅니다. 긍정적 인 수익률은 거래 비용 후 55.74 %로 장거리 포트폴리오의 가치는 놀라 울 정도로 높습니다. 두 번째로 좋은 모델은 RAF로, 트랜잭션 비용 후 평균 수익률은 0.23 %이지만 약간 높은 표준 편차 (0.0209 LSTM 대 0.0215 RAF)입니다. DNN은 물류 회귀와 비교하여 거래 비용 (여전히 통계적으로 유의미 함)을 얻은 후 하루에 평균 0.12 %의 수익률로 3 위를 차지했습니다. 가장 단순한 모델은 거래 비용 이후 하루 평균 0.06 %의 평균 수익률을 달성합니다.이 비용은 더 이상 0과 크게 다르지 않습니다 (Newey-West t- 통계 1.6666, 임계 값 1.9600). LSTM은 문헌에 비해 강력한 성능을 보여줍니다. Krauss et al.의 앙상블. 그라디언트가 증가 된 나무들로 구성된 2017 년과 무작위 포리스트는 동일한 시간대, 데이터 세트 및 거래 후 비용에서 하루 평균 0.25 %의 수익을 산출합니다. 다시 말해 단일 모델 인 LSTM은 본격적인 앙상블보다 약간 더 강력한 성능을 제공합니다.

리스크 특성 : 표 3의 패널 B에서 우리는 리스크 특성에 관한 혼합 된 그림을 관찰합니다. 위험에 처한 일일 가치 (VaR) 측면에서 LSTM은 RAF 후 4.95 %에 비해 5.45 %의 1 % VaR로 RAF 이후 2 위를 차지합니다. 가장 위험한 전략은 전체 시장의 1 %에서 7.66 %의 손실이 초과되는 로지스틱 회귀 모델에서 발생합니다. 일반 시장에서의 구매 및 보유 투자보다 2 배 이상 위험합니다. 그러나 LSTM은 다른 모든 모델 및 일반 시장에 비해 52.33 퍼센트의 가장 낮은 최대 축소 율을 보입니다.

연간 리스크 수익률 메트릭스 : 표 3의 패널 C에서 리스크 수익률 메트릭스를 연간 단위로 분석합니다. 우리는 LSTM이 RAF (67.87 %), DNN (24.60 %), LOG (7.11 %) 및 일반 시장 (9.25 %)에 비해 거래 비용 후 가장 높은 연간 수익률을 82.29 % 달성했다고 봅니다. 연례 표준 편차는 모든 벤치 마크에 비해 33.23 퍼센트로 두 번째로 낮은 수준입니다. Sharpe 비율은 표준 편차로 초과 수익률을 조정하므로 재무의 신호 대 잡음비 또는 위험 단위당 수익률로 해석 할 수 있습니다. 우리는 LSTM이 2.34의 가장 높은 레벨을 달성하고 RAF가 1.87로 2 위를 차지하는 반면 다른 모든 방법은 1.0보다 훨씬 낮은 Sharpe 비율을 얻음을 봅니다.

재정적 관점에서, 우리는 두 가지 중요한 발견을했습니다. 첫째, LSTM은 수익 특성 및 위험 회피 계수 측면에서 명확한 증거로 RAF를 능가합니다. 따라서 우리는 시계열 예측 작업에 본질적으로 적합한 LSTM 네트워크를 선택하는 것이 표준 심층 학습뿐만 아니라 얕은 트리 기반 모델보다 뛰어나다는 것을 보여줄 수 있습니다. 둘째, 표준 로지스틱 회귀 분석은 최적의 정규화 값을 찾기 위해 샘플 간 교차 유효성 검사를 수행하더라도 기능 공간에서 동일한 수준의 정보를 캡처 할 수 없음을 보여줍니다.

4.1.4. 시간 경과에 따른 LSTM 수익성에 대한 비평
그림 5에서 우리는 1993 년 1 월부터 2015 년 10 월까지 전략적 성과를 시간별로 표시합니다. 우리는 가장 경쟁력있는 기술, 즉 LSTM 및 임의의 포리 스트에 중점을 둡니다.

도 5
고해상도 이미지 다운로드 (1MB) 전체 크기 이미지 다운로드
도 5. 1993 년 1 월부터 2015 년 10 월까지 LSTM과 RAF 성과를 대조하여 포트폴리오 비용, 즉 1 일 평균 1 달러의 평균 투자, 연간 평균 일일 수익률, 연간 Sharpe 비율 및 거래 비용 후 연간 평균 정확도에 대한 누적 이익을 개발.

1993 / 01-2000 / 12 :이 초기시기는 강한 성과를 특징으로합니다. 하루 평균 평균 수익률, 샤프 비율 및 정확도와 관련하여 LSTM이 RAF보다 우수합니다. 하루 1 달러 평균 투자에 대한 누적 판매 대금은 LSTM이 11 달러 이상, RAF가 8 달러 이상인 2000 년까지 도달합니다. 이러한 성능 향상을 고려할 때 LSTM 네트워크는 1997 년에 도입되었으며 2000 년대 후반에 GPU 컴퓨팅이 등장한 이후로만 구현할 수있었습니다. 따라서 90 년대의 예외적으로 높은 수익률은 LSTM이 당시 시장 전문가의 대다수에게 알려지지 않았거나 완전히 실현 불가능하다는 사실에 기인합니다. 비슷한 논쟁이 임의의 숲에도 적용됩니다.

2001 / 01-2009 / 12 : 두 번째 기간은 중재시기에 해당합니다. LSTM은 90 년에 비해 훨씬 낮은 수준 임에도 불구하고 모든 연도의 거래 비용 후에도 여전히 긍정적 인 수익을 낼 수 있습니다. 누적 된 지불금을 고려할 때, 우리는 LSTM의 우월한 성과가 무작위적인 숲에 비해 금융 위기까지 지속된다는 것을 알 수 있습니다. 이러한 트리 기반 방법의 주요 장점은 잡음과 이상 값에 대한 견고성입니다. RAF는 Sharpe 비율이 6에 이르면 예외적으로 높은 반품 및 일관된 정확도 값을 얻습니다. 따라서 1 USD 투자에 대한 총 지불금은 LSTM의 경우 4 USD이고 RAF의 경우 5.6 USD입니다. RAF 지불금의 대부분은 금융 위기 중에 달성됩니다.

이 완화 기간은 업계 전문가들 사이에서 이러한 전략의 확산이 확산됨에 따라 점차 수익성이 악화되고 있다고 생각하는 것이 합리적입니다. 그러나 RAF의 경우 2008/2009 년의 세계 금융 위기가 예외적 인 것으로 나타났습니다 - 수익성이 크게 호전되었습니다. 문헌에 따르면 이러한 이익은 두 가지 요인에 의해 좌우 될 수 있습니다. 첫째, 투자자들이 재정적 혼란의시기에 "숲을위한 나무를 잃어 버리는 것"(Jacobs and Weber, 2015, 75 페이지)이라고 믿는 것이 합리적입니다. 따라서 현실적인 가치 재정 차익 기회를 창출합니다. Clegg and Krauss 2018). 둘째, 변동성이 높은시기에는 차익 거래에 대한 제한도 예외적으로 높기 때문에 이러한 상대 가치 차익 거래 기회를 포착하기가 어려워집니다. 특히 Gregoriou (2012), Engelberg, Reed, Ringgenberg (2017) 등의 주식을 빌리는 것이 쉽지 않을 수 있습니다. 또는 더 심각한 경우에는 공매도가 금지 될 수 있습니다. 그러나 스프레드가 확대되고 유동성이 감소하면 수익률 상한제가 적용될 때와 같이 장기적인 측면이 영향을 받는다.

2010 / 01-2015 / 10 : 세 번째 기간은 악화시기에 해당합니다. 무작위적인 숲은 그 가장자리를 잃어 버리고 1 일 평균 1 달러의 투자를 기준으로 가치가 1 달러 이상을 파괴합니다. 대조적으로, LSTM은 거의 모든 연도에서 더 높은 정확도 점수를 계속 실현하고 거래 비용 후 거의 일정한 자본을 유지할 수 있습니다. 문헌과 비교할 때, Krauss et al. (2017)은 2010 년 현재 대규모 LOB 회수율을 보이고 있지만 단일 모델 LSTM 수익률은 0 부근에서 변동합니다. 그럼에도 불구하고, 제시된 기계 학습 방법의 우위는 차용 중이었던 것으로 보인다. 이 효과는 Bogomolov (2013), Rad, Low 및 Faff (2016), Green, Hand 및 Zhang (2017), Clegg 및 Krauss (2018)와 같은 양적 전략을 겨냥한 많은 학술 연구 논문에서 볼 수 있습니다. , 다른 사람 사이에서.

4.1.5. 산업 고장
구조를 식별하는 LSTM의 기능에서 비롯된 다음 포트폴리오의 특정 산업에 대한 잠재적 인 선호도를 분석합니다. 구체적으로, 우리는 그 당시의 S & P 500에서 포트폴리오의 산업 점유율과 그 산업의 점유율 간의 차이를 고려합니다. 양수 값은 해당 산업이 LSTM 네트워크에 의해 과중되어 있음을 나타내며 음수 값은 해당 가중치가 낮다는 것을 나타냅니다.

그림 6은 석유 및 가스, 기술, 재무 및 기타 모든 분야에서 가장 흥미로운 산업에 대한 우리의 연구 결과를 보여줍니다. 첫째, 우리는 90 년대 말에 기술 주식의 과다한 비중을 차지하고 있음을 알 수 있습니다 - 성장하는 닷컴 거품과 그 흉상에 해당합니다. 둘째, 우리는 2008/2009 년경 금융 증권의 상승을 관찰합니다. 이는 세계 금융 위기에 해당합니다. 셋째, 최근의 석유 공급 부족과 원유 가격의 큰 폭락과 함께 2014 년 현재 석유와 가스의 비중이 증가하고 있습니다. 주 : 상위 k와 플롭 k 포트폴리오에 대한 개별 GICS 산업의 상대적 비중을 나타내는 더 자세한 분석은 부록 8에서 제공됩니다. 각 산업의 과체중이 주요 시장 개발을 적절하게 포착한다는 것을 알 수 있습니다. 우리는 이러한 행동이 변동성 수준의 증가에 의해 주도되고, 다음 절의 그 시점에 대해 더 자세히 설명 할 것이라는 가설을 세웠다.

도 6
고해상도 이미지 다운로드 (291KB) 풀 사이즈 이미지 다운로드
도 6. 포트폴리오의 산업별시 장 점유율 - S & P 500 종목 수를 기준으로 계산 한 이들 업종의 시장 점유율. 양수 값은 업종이 비중 확대이고 그 반대의 경우도 마찬가지입니다.

4.2. 상단 및 플롭 주식의 일반적인 패턴
기계 학습 접근법 - 특히 인공 신경망 -은 일반적으로 블랙 박스 방법으로 간주됩니다. 이 섹션에서는 빛을 블랙 박스에 비추는 것을 목표로하여 상단 및 플롭 주식의 일반적인 패턴을 공개합니다.

첫째, 우리는 매우 간단하면서도 효과적인 분석을 수행합니다. 매일 우리는 상단 및 플롭 k 주식에 대한 모든 240 일 반환 시퀀스를 추출합니다 .9 그런 다음 5750 × 10 위쪽과 같은 수의 플롭 시퀀스를 서로 위에 겹쳐 씁니다. 보다 나은 표현을 위해 각 시퀀스의 240 개의 리턴을 하루의 0 레벨에서 시작하여 리턴 인덱스에 누적 한 다음이 리턴 인덱스 시퀀스의 평균을 구합니다. 따라서 우리는 상위 10 개와 플랍 10 개 패턴의 패턴을 포함하는 두 개의 일반화 된 시퀀스를 얻습니다. 결과는 모든 주식 (평균)에 걸친 단면의 거동과 대조되는 그림 7에 묘사되어있다. Jagadeesh와 Titman (1993)의 의미에서 볼 때 최상위와 최저주는 모두 평균 이하의 모멘텀을 보입니다. 즉, 횡단면과 비교하여 낮과 밤에 실적이 저조합니다. 하루에서 t 시까 지 (주의 : 예측은 t 일에 이루어집니다.) 최고 주가는 빠른 속도로 충돌하기 시작합니다. 평균 230 일 동안 얻은 수익의 약 50 %가 손실됩니다. 반대로 플랍 주식은 거래 전 10 일 동안 역 패턴을 보이고 점점 더 높은 수익률을 보입니다. LSTM이 플랍 주식과 최고 주식 사이에서 강한 공통점을 추출했음을 알 수 있습니다.

도 7
고해상도 이미지 다운로드 (198KB) 풀 사이즈 이미지 다운로드
도 7. LSTM 전략을 위해 거래하기 전에 240 하루의 순서에 걸쳐 최상위 및 최저주 10 주식의 평균화 된 정상 수익률 지수가 반환됩니다.

둘째,이 시각적 통찰력을 바탕으로, 우리는 최고 및 최저주에 대한 추가 시계열 특성을 구축합니다. 따라서 우리는 기술적 통계를 생성하기 위해 위와 동일한 방법론을 따릅니다. 즉, 각 주식에 대해 240 일의 반환 시퀀스를 계산하고, 원하는 통계를 계산하고, 모든 k 주식에 대해 평균을 구합니다. k∈ {1, 5, 10 , 100, 200}. 특히 다음 통계를 고려합니다.
•
(다중) 기간은 그래픽에서 Return_t_t-m으로 표시되는 m ∈ {1, 5, 20, 240}으로 3.2 절에서 정의 된대로 반환됩니다. 여기서 m은 순서 t의 마지막 요소 (즉, 예측이 이루어진 날). 또한 시퀀스의 날짜부터 시퀀스의 날짜까지의 누적 수익을 Return_t-20_t-240으로 표시합니다.

•
위와 동일한 기간 동안 계산되고 동일한 명명 규칙을 따르는 샘플 표준 편차.

•
각 시퀀스의 전체 240 일에 걸친 샘플 비대칭 및 첨도

•
Gateh, Goetzmann, Rouwenhorst (2006), Carhart (1997)의 의미에서 Carhart 회귀 계수. 따라서 각 주식의 알파 (FF_Alpha - 시장 움직임을 넘어선 주식의 특이한 수익률을 나타냄), 베타 (FF_Mkt-RF - 시장이 1 % 움직일 때 주가가 움직이는 양을 나타냄), 큰 마이너스 팩터 (FF_SMB - 작은 대 대형주에 대한 로딩을 나타냄), 높은 마이너스 낮은 팩터 (FF_HML - 성장주 대비 가치에 대한 로딩을 나타냄), 모멘텀 팩터 (FF_Mom - 모멘텀 팩터에 대한 로딩을 단기 반전 요인 (단기 반전 효과에 대한 부하량을 나타내는 FF_ST_Rev)과 R 제곱 (FF_R_squared- 요인 모델에 의해 설명 된 수익 분산의 비율을 나타냄)은 Jegadeesh and Titman (1993), Carhart (1997) . 이 계수는 거래를 위해 LSTM에 의해 선택되기 전의 개별 주식의 240 일 내역을 나타내며 결과 LSTM 전략이 이러한 요인에 노출되지는 않습니다 (이 분석에 대해서는 4.3 절 참조).


결과를도 8에 나타낸다. 마지막 단락의 그래픽 패턴은 이제 k의 다른 값에 대해 양적 방식으로 나타납니다. 첫째, 예측 이전의 마지막 주가에서 최고 주가는 매우 부정적인 수익률을 보였고, 플롭은 매우 긍정적 인 수익률을 보임. 이 행동은 Jegadeesh (1990), Lehmann (1990), Lo 및 MacKinlay (1990)에서 간략히 설명한 바와 같이 단기 반전 전략에 해당합니다. LSTM 네트워크는 독립적으로 주식 시장의 변칙을 찾았으며, 마지막 날에 급격히 하락한 주식은 다음 기간에 상승하는 경향이 있고 반대의 경우도 마찬가지입니다. 효과가 강할수록 k가 작아집니다. 즉, 포트폴리오에서 고려한 주식의 수가 더 적습니다. 두 번째로, 상위와 최저주 모두 Jegadeesh와 Titman (1993)의 의미에서 약한 모멘텀을 보인다. 예를 들어, 상위 10 개 주가는 매일 매일 평균 9.1 퍼센트의 모멘텀을 보였으며, 이는 모든 주식의 평균 인 11.7 퍼센트와 비교되었습니다. 플롭 주식도 비슷한 패턴을 보입니다. k가 작을수록 운동량 효과에 대한 실적이 저조합니다. 셋째, 표준 편차를 고려할 때 변동성이 중요한 역할을한다는 것이 분명해진다 (LeBaron, 1992 참조). 분명히, 높은 변동성 주식은 시장에 비해 선호되며 변동성은 순위의 더 극단적 인 부분에 대해 증가하고 있습니다. Baker, Bradley, Wurgler (2011), Frazzini and Pedersen (2014), Hong and Sraer (2016)를 참조하십시오. 베타 버전의 변동성은 중요한 수익 예측 신호가 될 수 있습니다. 주식. 또한 비대칭 성은 일반 시장과 유사하며, 상위 및 최저주 주가의 수익률은 일반 시장보다 더 높습니다. 이는 Kumar (2009), Boyer, Mitton 및 Vorkink의 저작물과 관련하여 잠재적 인 수익 예측 신호입니다 ( 2010), Bali, Cakici, Whitelaw (2011)에서 "lottery-type"기능이있는 주식에 투자했습니다. 마지막으로, 위에서 언급 한 시계열 특성이 회귀 계수에서도 확인 된 것을 볼 수 있습니다. 상위 및 플롭 k 주식은 더 높은 베타, 운동량 팩터에 대한 음의 로딩 및 단기 반전 팩터에 대한 양의 로딩을 보여 주며, 각각의 크기는 k에 대한 더 낮은 값으로 증가합니다. 우리는 중소기업 요소에 약간의 로딩을 보았습니다. 즉, S & P 500 구성 종목 중 더 작은 종목이 선택됩니다. 이는 보통 변동성이 더 큽니다.

도 8
고해상도 이미지 다운로드 (2MB) 전체 크기 이미지 다운로드
도 8. LSTM 전략에 대한 상위 및 플롭 k 주식의 시계열 특성 통계는 먼저 섹션 4.2의 글 머리 기호 목록 (명명 규칙 포함)에 설명 된대로 맨 위 또는 플롭 k의 각 주식에 대한 240 일 반환 시퀀스에 대해 계산 된 다음 모든 최상위 k 또는 모든 플럽 k 주식에 대해 평균을 계산합니다. 그러나 평균은 모든 주식에서 비슷하게 계산됩니다. 상단 및 플롭 k 주식에 대해 별도로 각 행을 따라 색상 코딩이 있음에 유의하십시오. 따라서 녹색이 진하고 값이 높을수록 적색이 어두울수록 값은 낮아집니다. (이 그림의 범례에서 색상에 대한 참조를 해석하려면이 기사의 웹 버전을 참조하십시오.)

LSTM 네트워크가 240 일간의 표준화 된 수익률에서 이러한 패턴을 독자적으로 추출했다는 점을 감안할 때, 일부는 일반적으로 알려진 자본 시장 변이와 얼마나 잘 연관되어 있는지를 아는 것이 놀랍습니다. 식별 된 특성이 명시 적으로 기능으로 코딩되지 않고 LSTM 네트워크에서 자체적으로 파생된다는 점을 감안할 때이 찾기는 매력적입니다. mutli와 함께 제공되는 임의의 포리스트와 같은 메모리없는 모델과 다른 주요 차이점 -period는 기능으로 반환됩니다.

4.3. 수익성의 원천
간략화 된 거래 전략 :이 섹션에서는 이전 분석을 토대로 단순화 된 거래 전략을 구성합니다. 도 2 7과 8에서 볼 수 있듯이, 가장 지배적 인 특징은 거래 전 마지막 날의 수익률 하락 또는 가파른 상승이다. 유사한 노트에서, Krauss et al. (2017)는 마지막 수익률이 기계 학습 모델에서 가장 중요한 변수라는 사실을 알게되었으며 Moritz와 Zimmermann (2014)도 마찬가지였습니다. 간단히하기 위해, 우리는이 가장 중요한 점을 토대로 단기간 반전의 창시자 중 두 명인 Jegadeesh (1990), Lehmann (1990)을 느슨하게 따릅니다. 구체적으로, 우리는 거래일 이전에 가장 부정적 5 일 누적 수익을 가진 상위 k 종목을 오랫동안 가지고 거래일 이전에 가장 긍정적 인 5 일 누적 수익 - 모든 동등한 가중치를 가진 플랍 종목을 짧게 유지합니다. 이 매우 간단하면서도 투명한 전략을 위해 거래 비용보다 0.23 %, 거래 비용보다 0.03 % 높은 일일 평균 수익률을 얻습니다. 따라서 가장 현저한 특징, 즉 지난 5 일 누적 수익 만 자본화하면 트랜잭션 비용 이전에 LSTM 전략의 수익률이 약 50 %가됩니다. 거래 비용 후, 단기 반전 전략은 LSTM과는 반대로 그 모서리를 잃는다. 그러므로, 우리는 추가적인 설명력이 다른 특징들에 포함되어 있음을 조심스럽게 결론 지을 수 있으며, 그림 8에서 집합 적 관점에서 직접적으로 식별 할 수없는보다 미세한 패턴을 형성한다. 이 발견을 바탕으로, 우리는 다음으로 나아가서 LSTM 수익이 공통적 인 체계적 위험 원천에 노출되는 것을 평가합니다.

체계적 위험 원에 노출 : 포트폴리오 분석 및 Krauss et al.과 유사하게 일반적으로 수행됩니다. (2017), 우리는 체계적 위험의 공통적 인 소스에 대한 long short 포트폴리오의 노출을 평가합니다. Fama와 French (1996)에서와 같이 Fama-French 3 요소 모델 (FF3)을 사용합니다. 따라서 시장 요인, 소액 자본 스톡 (SMB)에 대한 익스포저를 측정하는 요소 및 하이 마이너스 낮은 장부가 시장 (HML)에 대한 익스포저를 측정하는 요소로 구성됩니다. 또한 우리는 모멘텀 팩터 (Carhart, 1997), 단기 리버설 팩터 (Gatev et al., 2006) 및 장기 리버설 팩터를 포함한다. 이러한 요소 모델에 사용 된 모든 데이터는 Kenneth French의 웹 사이트에서 가져온 것입니다 .10 기본 아이디어는 횡단면 가격 변동에 대한 추가 노출을 측정하는 것입니다. 우리의 연구 결과는 표 4에 요약되어있다. 처음에 LSTM은 모든 모델 중에서 가장 낮은 0.0330의 계수를 보여줍니다. 다시 말해서, 0.46 퍼센트의 일일 LSTM 원시 수익률의 일부분 만이 그러한 공통적 인 체계적 위험의 원인으로 설명 될 수 있습니다. 사실 하루에 0.42 %의 알파가 남아 있습니다 (절편). 대조적으로, RAF는 0.1338의 더 높은 결정 계수를 가지고 있으며, 0.43 %의 원시 수익률과 비교하여 매일 알파의 0.34 %만이 남아 있습니다. R2는 낮지 만 (재무 연구에서 종종 그러할 수 있음 - Gatev et al., 2006 참조) - 우리는 여전히 요인 부하량을 우리의 기대치와 비교할 수 있습니다. LSTM은 기본적으로 시장 중립적입니다. 즉, 우리는 동일한 금액을 투자하는 길고 짧은 포트폴리오가 유사한 베타를 전시한다는 것을 의미합니다. 대조적으로, 다른 전략은 짧은 다리보다 긴 다리에서 약간 높은 베타 주식을 선호하는 것 같습니다. SMB 요소는 일반적으로 중요하지 않으며 모든 모델에서 0에 가깝습니다. HML 노출은 전략에 따라 다릅니다. LSTM이 매력적인 주식 (부정적 및 중대한 적재)을 선호하는 반면에, RAF는 가치주 (긍정적이고 중요한 적재)를 선택하는 경향이 있습니다. DNN과 간단한 로지스틱 회귀 (logistic regression)에는 노출이 없습니다. 가장 흥미로운 요소는 횡단면 가격 동향을 포착하는 요소로서, 우리가 공급하는 기능에 크게 부합한다는 점을 감안할 때. 우리는 모든 모델이 모멘텀과 단기 리버설 팩터에 대해 긍정적이고 통계적으로 유의미한 영향을 미친다는 것을 알 수 있습니다. 이는 단기적 횡단면 가격 역학이 포착됨을 의미합니다. 흥미롭게도 LSTM에 비해 물가 회귀 분석에서는 이러한 가격 기반 요인 로딩이 더 우월합니다. 이러한로드 증가는 단순한 모델이 제공된 기능에서 고차원 패턴을 구조적으로 추출 할 수 없다는 사실에 기인합니다. 마지막으로, 장기 역전 요인은 LSTM에 대해 중요하지 않으며, 중요도는 낮지 만 다른 전략에 대해서는 약간 부정적이다. 우리는 매우 짧은 거래 기간을 감안할 때이 요소는 일반적으로 설명력이 낮다고 믿습니다. 간단히 말해서 LSTM 수익은 조직적 위험 원천으로 간신히 설명 될 수 있습니다. 우리가 배포 한 다른 기계 학습 모델의 수익보다 훨씬 적습니다.

표 4. 1992 년 12 월에서 2015 년 10 월까지 거래 비용이 발생하기 전에 LSTM, RAF, DNN 및 LOG 전략의 체계적 위험 원에 노출. 표준 오류는 괄호 안에 표시됩니다.

LSTM RAF DNN 로그
(절편) 0.0042 * ⁎ * 0.0034 * ⁎ * 0.0021 * ⁎ * 0.0014 * ⁎ *
(0.0003) (0.0003) (0.0003) (0.0003)
시장 0.2107 * ⁎ * 0.0926 ** 0.1845 * ⁎ *
(0.0255) (0.0248) (0.0293) (0.0303)
SMB 0.0117 
(0.0484) (0.0470) (0.0556) (0.0574)
HML 0.5377 * ⁎ * 0.1103
(0.0574) (0.0557) (0.0659) (0.0681)
모멘텀 0.1241 * ⁎ * 0.1098 ** 0.8903 * ⁎ * 0.6865 * ⁎ *
(0.0345) (0.0334) (0.0396) (0.0409)
단기 반전 0.3792 * ⁎ * 0.7475 * ⁎ * 0.9620 * ⁎ * 1.0885
(0.0336) (0.0327) (0.0386) (0.0399)
장기 반전 0.0549 
(0.0683) (0.0663) (0.0785) (0.0811)
R2 0.0330 0.1338 0.1825 0.1734
Adj. R2 0.0320 0.1329 0.1816 0.1725
Num. obs. 5750 5750 5750 5750
RMSE 0.0206 0.0200 0.0237 0.0244
* ⁎ * p <.001, ** p <.01, * p <.05.


4.4. 미세 구조를 시장에 내놓기위한 견고성
마지막 하위 섹션의 핵심 결과는 LSTM 기반 주식 선택이 일반적인 역 투자 전략과 유사하다는 점입니다. 미세 구조 효과, 특히 입찰 촉구 (bid-ask bounce)는 콘라트와 카울 (1989), Jegadeesh (1990), Jegadeesh and Titman (1995), Gatev et al. (2006). 근본적인 이유는 간단합니다. LSTM 전략은 최근 패자를 사고 최근 수상자를 판매하는 경향이 있습니다. 조건부로 상위 k 종목 중 하나 인 경우, 우승자의 견적은 물음표가 될 가능성이 높고 최저 기준 종목 중 하나 인 경우 조건부로 낙찰자의 견적은 역 견해에 대한 추론과 유사합니다 Gatev et al. (2006). 암묵적으로, 우리는 낙찰자의 경우 입찰에서 구매하고 승자의 경우에는 물음에 팔 것입니다. 역을 적용하면 포지션을 커버 할 수 있습니다 - 최근 패자의 가격 급상승 부분은 입찰가에서 물음에 뛰어들 수 있고 최근 우승자의 가격 하락의 일부는 입찰에서 입찰로 이동하여 발생할 수 있습니다. 이러한 고려 사항을 고려할 때, 우리 연구 결과의 견고성을 분석 할 필요가 있습니다 .11이 문제에 대한 몇 가지 해결책이 있습니다.

첫째, 더 긴 무역 지평은 전형적으로 미세 구조 효과에 더 강합니다. 예를 들어, Lehmann (1990)의 단기 반전 전략 또는 Huck, 2009, Huck, 2010 년 기계 학습 전략에서 LSTM 전략의 주간 변형을 소개합니다. 낮은 회전율 (주간 vs. 일간 ), 데이터로부터 구조를 성공적으로 추출하기 위해 LSTM을위한 충분한 수의 훈련 예를 보유하는 것. 후자는 연구 설계를 크게 변경하지 않고 월별 변종을 제외합니다. 특히 LSTM은 섹션 3에 설명 된 토대와 완전히 유사하지만 1 일 기준이 아닌 5 일 기준으로 설계됩니다 .12 또한 LSTM 전략의 5 가지 중복 포트폴리오를 5 일간의 예측 수평선으로 구현합니다 시작일 (Jegadeesh & Titman, 1993)에 의해 도입 된 편견을 피하십시오. 따라서 각 포트폴리오는 한 거래일만큼 다른 포트폴리오와 상쇄되고 수익은 모든 포트폴리오에서 평균됩니다. 우리는 5 가지 포트폴리오 모두에 대해 매일 투자 자본 시장 진입을 기록하므로 비교 가능성을 위해 일일 수익을 낼 수 있습니다.

둘째, VWAP (volume-weighted-average-prices)에 대한 처형은 현실적이며 입찰 촉탁에 훨씬 덜 취약합니다 (Lee, Chan, Faff, & Kalev, 2003 참조). 따라서 우리는 1998 년 1 월부터 2015 년 10 월까지 QuantQuote의 모든 S & P 500 주식에 대해 미세 공정 거래 데이터를 사용하여 피쳐 엔지니어링, 타겟 생성 및 백 테스팅에 사용되는 VWAP를 생성합니다 (3.13 절 참조). 구체적으로, 17 분간의 23 개 빈 (bin)에 각 거래 일의 분당 (9시 30 분부터 16 시까 지, 개회를 포함하여) 종료하므로 23 개의 VWAP를 얻을 수 있습니다. 우리는 22 번째 VWAP를 기능 생성을위한 앵커 포인트로 사용하고, 23 번째 VWAP를 사용하여 3.2 절과 완전히 유사한 기능을 생성합니다.

셋째, Gatev et al. (2006)은 입찰 요청 반송에 대한 적절한 해결책입니다. 특히, 우리는 신호 발생 후 거래 하루 만에 실행을 연기합니다. 이 규칙은 주간 전략에만 의미가 있습니다. 일일 전략의 경우, 지연은 전체 예측 수평선을 포함하여 예측을 무효화합니다.

넷째, 완전성을 위해이 논문 전반에 걸쳐 5 bps의 트랜잭션 비용을 사용합니다. 이는 미국의 대형 대문자에 대해 상당히 견고한 가치입니다. 예를 들어, Jha (2016)는 유사한 시간대에 걸쳐 미국 주식 우주의 가장 큰 500 주식에 대해 단지 2 bps를 가정합니다.

요약하면 LSTM 전략에 대해 다음과 같은 견고성 검사를 실행합니다. 모델 M1은 이전 단원에서 논의 된 표준 LSTM 전략의 결과를 보여주는 기준선입니다. 즉, 일일 매출과 종가에서 실행되지만 1998 년부터 2015 년까지 QuantQuote 데이터 세트의 시간 틀로 제한됩니다. 모델 M2는 종가 대신 VWAP에서이 전략을 실행할 때의 효과를 보여줍니다. 모델 M3-M5는 기본 전략의 주간 변형입니다. 이에 따라 M3는 종가로, M4는 VWAP로, M5는 하루 종일 종가로 종가로 실행됩니다. 이러한 변형의 결과는 표 5에 설명되어 있습니다. 절반 전후 5 bps의 거래 비용 전후입니다.

표 5. 패널 A는 서로 다른 거래 빈도 및 실행 유형 (M1에서 M5까지)을 사용하여 LSTM 모델 변형의 이름을 지정합니다. 패널 B, C 및 D는 1998 년 1 월부터 2015 년 10 월까지 일반 시장 (MKT)과 비교하여 5 가지 모델 변형에 대한 거래 비용 전후의 포트폴리오의 성과 특성을 보여줍니다. MKT는 Kenneth R. French의 데이터 라이브러리에서 일반적인 시장을 나타냅니다. 여기를 참조하십시오. 패널 B는 일일 수익률 특성을 나타냅니다. 패널 C는 일일 위험 특성을 보여줍니다. 패널 D는 연간 환급 리스크 측정 지표를 보여줍니다. Newey-West 표준 오류가 사용됩니다.

거래 비용 전 거래 비용 후 
A 모델 M1 M2 M3 M4 M5 M1 M2 M3 M5 MKT
빈도 일별 일일 주간 주간 주간 일간 주간 주간 주간 주간 -
실행 옷장 VWAPt 옷장 VWAPt 옷장 VWAPt 옷장 VWAPt -
B 평균 수익률 (long) 0.0025 0.0021 0.0014 0.0012 0.0013 0.0015 0.0011 0.0012 0.0010 0.0011 0.0003
평균 복귀 (짧은) 0.0014 0.0015 0.0001 0.0001 0.0000 0.0004 0.0005 0.0001 0.0001 0.0002 -
평균 반환 값 0.0040 0.0036 0.0015 0.0013 0.0013 0.0020 0.0016 0.0011 0.0009 0.0009 0.0003
표준 오차 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0002
t- 통계 11.9814 11.5662 5.7083 5.1998 4.9941 5.9313 5.1980 4.1749 3.6172 3.4622 1.8651
최소 0.2176 0.1504 0.1261 0.1156 0.1246 0.2193 0.1522 0.1265 0.1160 0.1250 0.0895
사 분위수 1 0.0064 0.0064 0.0068 0.0064 0.0068 0.0084 0.0084 0.0072 0.0068 0.0072 0.0054
중앙값 0.0030 0.0027 0.0009 0.0007 0.0010 0.0010 0.0007 0.0005 0.0003 0.0006 0.0008
사 분위수 3 0.0136 0.0124 0.0092 0.0082 0.0089 0.0116 0.0104 0.0088 0.0078 0.0085 0.0064
최대 0.1837 0.1700 0.2050 0.1814 0.1997 0.1815 0.1678 0.2045 0.1810 0.1993 0.1135
점유율> 0 0.5847 0.5807 0.5337 0.5299 0.5379 0.5276 0.5212 0.5216 0.5120 0.5234 0.5384
표준 dev. 0.0224 0.0208 0.0185 0.0177 0.0181 0.0224 0.0208 0.0185 0.0177 0.0181 0.0127
비뚤어 짐 0.0682 0.4293 0.9199 0.6518 0.8163 0.0682 0.4293 0.9195 0.6515 0.8160 0.0737
첨도 10.9634 6.1028 12.3432 9.5637 12.7913 10.9634 6.1028 12.3409 9.5620 12.7897 6.7662
C 1 % VaR 0.0571 0.0524 0.0516 0.0470 0.0493 0.0591 0.0544 0.0520 0.0474 0.0496 0.0341
1 퍼센트 CVaR 0.0861 0.0717 0.0662 0.0659 0.0673 0.0880 0.0736 0.0666 0.0663 0.0676 0.0491
5 퍼센트 VaR 0.0271 0.0268 0.0251 0.0239 0.0252 0.0291 0.0287 0.0255 0.0243 0.0256 0.0195
5 % CVaR 0.0468 0.0432 0.0412 0.0395 0.0403 0.0487 0.0452 0.0416 0.0399 0.0407 0.0297
맥스. 삭감 0.4660 0.3717 0.3634 0.4695 0.3622 0.5230 0.6822 0.4041 0.5808 0.3794 0.5467
D Return pa 1.5439 1.3639 0.3939 0.3384 0.3328 0.5376 0.4287 0.2604 0.2103 0.2052 0.0668
초과 반환 파 1.4923 1.3159 0.3655 0.3112 0.3056 0.5063 0.3996 0.2348 0.1856 0.1806 0.0450
표준 dev. 아빠 0.3561 0.3308 0.2940 0.2818 0.2879 0.3557 0.3305 0.2939 0.2817 0.2879 0.2016
아래쪽 dev에. 아빠 0.2192 0.1962 0.1863 0.1802 0.1851 0.2323 0.2103 0.1891 0.1830 0.1879 0.1424
샤프 비율 PA 4.1908 3.9777 1.2433 1.1043 1.0615 1.4233 1.2091 0.7988 0.6589 0.6274 0.2234
Sortino 비율 PA 7.0444 6.9507 2.1145 1.8784 1.7982 2.3139 2.0380 1.3770 1.1488 1.0916 0.4689
거래 비용 후 기본 LSTM 전략 M1은 1998 년부터 2015 년까지보다 짧은 기간에 하루 평균 0.20 %의 수익률을 나타냅니다. 모델 M2의 경우 마감 가격 대신 VWAP를 사용하면 하루에 0.16 %로 악화됩니다 - 5 세 이상의 t 통계로 여전히 통계적으로 유의하고 43 %의 수익률로 경제적으로 의미가 있습니다. 주간 전략은 하루에 비슷한 수익률을 보입니다. 즉, M3 (종료시 실행)의 경우 0.11 %, M4 (VWAP의 경우)의 경우 0.09 %, M5의 경우 0.09 % - 기다림) - 모두 통계적으로나 경제적으로 의미가 3 이상이고 연간 수익률이 20 %를 넘는다. 나머지 표는 표 3과 완전히 유사하며 견고성 검사 후 일반 시장에 비해 LSTM 전략의 상대적 성능이 우수함을 보여줍니다.

그러나 최근 몇 년 동안 그림 9에서 볼 수 있듯이 수익률은 평평 해 졌으므로 LSTM 모서리가 차익 거래를 한 것으로 보인다. 이러한 사실에도 불구하고 1998 년부터 2009 년까지의 시장 마찰에 비추어 모델 성과는 견고하며 특히 금융 위기를 중심으로 한 수익률 상승이 특히 돋보입니다.

도 9
고해상도 이미지 다운로드 (328KB) 풀 사이즈 이미지 다운로드
도 9. 포트폴리오에 대한 1998 년 1 월부터 2015 년 10 월까지 LSTM 모델의 성능을 비교합니다. 즉, 거래 비용 후 평균 1 달러 평균 투자로 누적 이익을 개발합니다.

5. 결론
본고에서는 1992 년 12 월부터 2015 년 10 월까지 S & P 500의 대규모 금융 시장 예측 작업에 장 단기 메모리 네트워크를 적용합니다. 우리의 연구를 통해 우리는 문헌에 3 가지 주요 공헌을했다 : 첫 번째 공헌은 금융 시계열 예측 작업에 대한 LSTM 네트워크의 대규모 경험적 적용에 초점을 둔다. 우리는 전체 데이터 과학 가치 사슬을 철저하게 준수하는 심도있는 가이드를 제공합니다. 구체적으로, 우리는 적절한 예측 작업을 프레임 화하여 240 일 반환 시퀀스의 형태로 감각적 인 특징을 도출하고 모델 처리를 용이하게하기 위해 사전 처리 중에 기능을 표준화하며 적절한 LSTM 아키텍처 및 학습 알고리즘을 논의하고 예측을 기반으로 거래 전략을 도출합니다 기존 문헌과 일치한다. LSTM의 결과를 단순한 로지스틱 회귀뿐만 아니라 표준 심층 그물망 인 무작위 포리스트와 비교합니다. 우리는 본 도메인에 본질적으로 적합한 방법론 인 LSTM이 표준 심층 그물망과 로지스틱 회귀를 매우 명확하게 마는 것으로 나타났습니다. 대부분의 경우 - 글로벌 금융 위기를 제외하고는 무작위적인 숲도 우월합니다. 거래 비용 이전에 통계적으로 경제적으로 유의미한 수익률 0.46 %를 얻은 결과는 시장 효율성의 준결승 적 형태에 대한 명확한 도전을 제시하며, 2010 년까지이 영역에서 심층적 인 학습이 효과적인 예측 모델링 기술 이었음을 보여줍니다 . 이러한 결과는 가격 마비 대신 VWAP에 대한 일일 LSTM 전략을 실행할 때와 하루 후 대기 기간으로 LSTM 전략의 주간 변형을 실행하는 경우 수익성이 통계적으로 경제적으로 유의미하다는 점을 고려하면 시장 마찰에 비추어 크게 강력합니다 신호 생성. 2010 년 현재 시장은 LSTM 수익성이 제로 부근에서 변동하고 RAF 수익성이 엄격하게 음수 영역에 집중하면서 배포하는 기계 학습 방법과 관련하여 효율성이 향상됩니다.

또한 LSTM 네트워크의 개념적 및 경험적 측면은 순수한 금융 시장 애플리케이션을 뛰어 넘지 만 다량의 교육 데이터가 포함 된 다른 시계열 예측 작업에이 효과적인 방법론을 적용하려는 다른 연구자를위한 지침으로 사용됩니다.

둘째, 블랙 박스 "LSTM"을 풀고 수익성있는 거래를 위해 선택된 주식의 일반적인 패턴을 공개합니다. 우리는 LSTM 포트폴리오가 평균 이하의 모멘텀, 강력한 단기 반전 특성, 높은 변동성 및 베타를 갖는 주식으로 구성됨을 발견했습니다. 이러한 모든 발견은 기존 자본 시장의 예외와 어느 정도 관련이 있습니다. 그들 중 일부는 표준화 된 원시 수익률의 240 일 시퀀스로부터 LSTM에 의해 독자적으로 추출되는 것을 볼 수 있습니다. LSTM 신경망이 금융 시장 데이터로부터 배우는 더욱 섬세한 패턴을 식별하고보다 세련되고 규칙 기반의 거래 전략에서 이러한 패턴의 수익 잠재력을 검증하기위한 향후 연구가 필요합니다.

셋째, LSTM 포트폴리오의 일반적인 패턴을 기반으로 규칙 기반 거래 전략을 간소화했습니다. 구체적으로 말하자면, 단기 우승자를 짧게하고 단기 패자를 사서 LSTM 응용 프로그램에서와 마찬가지로 하루 동안 포지션을 유지합니다. 이 투명하고 간소화 된 전략을 통해 거래 비용에 앞서 하루에 0.23 %의 수익을 얻습니다. LSTM의 약 50 %가 반환됩니다. 체계적인 위험의 일반적인 출처에 대한 추가 회귀 분석은 LSTM의 0.42 %의 알파를 거래 비용 이전에 공개하고 우리가 배포 한 다른 모델에 비해 일반적으로 위험 노출도를 낮 춥니 다.

전체적으로 우리는 LSTM 네트워크가 시끄러운 금융 시계열 데이터로부터 의미있는 정보를 효과적으로 추출 할 수 있음을 성공적으로 증명했습니다. 무작위적인 숲, 표준 깊은 그물 및 로지스틱 회귀와 비교하여 예측 정확도와 거래 비용 후 일별 수익과 관련하여 선택하는 방법입니다. 결과적으로, LSTM 네트워크의 형태로 깊은 학습이 이루어 지므로이 영역에서도 진보가 이루어진 것으로 보입니다.

충수. 상세한 산업 고장
도 A1.

도 A1
고해상도 이미지 다운로드 (987KB) 풀 사이즈 이미지 다운로드
도 A1. "상위 10 위"와 "10 위"포트폴리오에서 시간이 지남에 따라 변화하는 산업 점유율은 S & P 500 지수에서 해당 산업의 주식 점유율을 뺀 값입니다. 양수 값은 업종이 비중 확대이고 그 반대의 경우도 마찬가지입니다.